# CLAUDE.md

该文件为 Claude Code (claude.ai/code) 在此代码库中工作时提供指导。

## 项目概述

这是一个使用纯 HTML、CSS 和 JavaScript 以及 Three.js 构建的交互式 3D 太阳系可视化项目。该项目使用准确的天文数据、椭圆轨道和双时间模式模拟真实的太阳系。

## 运行方法

直接在网页浏览器中打开 `index.html` 即可。不需要构建过程或服务器 - 这是一个客户端网页应用程序。

项目使用 CDN 链接引入依赖库：
- Three.js r128
- Three.js OrbitControls

## 核心架构

### 主要组件

**SolarSystem 类** (`solar-system.js`)：包含所有仿真逻辑的主应用程序类
- **场景管理**：Three.js 场景、相机、渲染器、光照设置
- **天体对象**：太阳、8颗行星、1200+ 个小行星，具有真实数据
- **时间系统**：双模式系统（静态/动画），具有可配置的时间尺度
- **轨道计算**：使用偏心率和倾斜角的真实椭圆轨道数学
- **界面管理**：动态标签、时间控制和模式切换

### 数据结构

**celestialData 对象**：包含所有天体的真实天文数据：
- 物理属性（半径、颜色）
- 轨道参数（距离、周期、偏心率、倾斜角）
- 旋转数据（自转周期）
- 显示调整（气态巨行星的尺寸调整）

### 时间系统架构

两种不同的时间模式：
- **静态模式**：基于 `Date.now()` 的实时时间，行星运动最小
- **动画模式**：加速时间（1秒 = 1周），戏剧性的运动可视化

时间计算通过 `getSimulationTime()` 方法处理，所有天体对象更新都引用该方法。

### 轨道数学

使用真实的椭圆轨道计算：
1. 基于轨道周期的平均近点角计算
2. 通过牛顿迭代求解偏心近点角
3. 计算真近点角以获得实际位置
4. 使用轨道倾斜变换进行 3D 定位

### 渲染优化

- 禁用阴影系统以防止太空环境中的视觉伪影
- 使用屏幕空间投影的动态标签定位
- 小行星带使用实例化几何体方法以提高性能

## 关键特性

**双时间模式**：在实时观察和加速动画之间切换
**精确轨道**：具有真实偏心率值的真椭圆路径
**智能缩放**：具有可见性调整的比例天体尺寸
**动态标签**：行星名称跟随天体并处理遮挡
**小行星带**：1200个独立小行星，具有真实分布和运动
**空格键控制**：在动画模式下按空格键可暂停/继续时间演进

## 开发说明

修改天体数据时，请保持 `celestialData` 对象中建立的结构。距离值以 AU 为单位，周期以地球日为单位。

出于性能考虑，小行星计数和细节级别在保持视觉冲击的同时平衡了流畅的动画效果。

时间系统需要在所有动画计算中一致使用 `getSimulationTime()` 以保持模式之间的同步。

UI 元素使用固定定位和 z-index 管理，以便在 3D 画布上正确分层。